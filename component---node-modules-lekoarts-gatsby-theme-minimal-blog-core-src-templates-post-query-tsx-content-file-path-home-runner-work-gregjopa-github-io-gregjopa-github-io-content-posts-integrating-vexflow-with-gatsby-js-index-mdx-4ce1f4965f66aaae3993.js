"use strict";(self.webpackChunkgregjopa_github_io=self.webpackChunkgregjopa_github_io||[]).push([[717],{8804:function(e,t,n){n.d(t,{F:function(){return d},Z:function(){return p}});var r=n(7294),o=n(8733),a=n(795),i=n(6920),l=n(6799),c=n(8871);var s=e=>{let{post:t}=e;return null};const u=["16px","8px","4px"].map((e=>"rgba(0, 0, 0, 0.1) 0px "+e+" "+e+" 0px"));var m=e=>{let{data:{post:t},children:n}=e;return(0,o.tZ)(i.Z,null,(0,o.tZ)(a.X6,{as:"h1",variant:"styles.h1"},t.title),(0,o.tZ)("p",{sx:{color:"secondary",mt:3,a:{color:"secondary"},fontSize:[1,1,2]}},(0,o.tZ)("time",null,t.date),t.tags&&(0,o.tZ)(r.Fragment,null," â€” ",(0,o.tZ)(l.Z,{tags:t.tags}))),(0,o.tZ)("section",{sx:{my:5,".gatsby-resp-image-wrapper":{my:[4,4,5],borderRadius:"4px",boxShadow:u.join(", "),".gatsby-resp-image-image":{borderRadius:"4px"}},variant:"layout.content"}},n),(0,o.tZ)(s,{post:t}))};const d=e=>{var t,n,r;let{data:{post:a}}=e;return(0,o.tZ)(c.Z,{title:a.title,description:a.description?a.description:a.excerpt,image:a.banner?null===(t=a.banner)||void 0===t||null===(n=t.childImageSharp)||void 0===n||null===(r=n.resize)||void 0===r?void 0:r.src:void 0,pathname:a.slug,canonicalUrl:a.canonicalUrl})};function p(e){let{...t}=e;return r.createElement(m,t)}},6799:function(e,t,n){var r=n(8733),o=n(7294),a=n(1883),i=n(3494),l=n(9706);t.Z=e=>{let{tags:t}=e;const{tagsPath:n,basePath:c}=(0,i.Z)();return(0,r.tZ)(o.Fragment,null,t.map(((e,t)=>(0,r.tZ)(o.Fragment,{key:e.slug},!!t&&", ",(0,r.tZ)(a.Link,{sx:e=>{var t;return{...null===(t=e.styles)||void 0===t?void 0:t.a}},to:(0,l.Z)("/"+c+"/"+n+"/"+e.slug)},e.name)))))}},8871:function(e,t,n){var r=n(7294),o=n(1883),a=n(4232);t.Z=e=>{let{title:t="",description:n="",pathname:i="",image:l="",children:c=null,canonicalUrl:s=""}=e;const u=(0,a.Z)(),{siteTitle:m,siteTitleAlt:d,siteUrl:p,siteDescription:f,siteImage:h,author:g}=u,y={title:t?t+" | "+m:d,description:n||f,url:""+p+(i||""),image:""+p+(l||h)};return r.createElement(r.Fragment,null,r.createElement("title",null,y.title),r.createElement("meta",{name:"description",content:y.description}),r.createElement("meta",{name:"image",content:y.image}),r.createElement("meta",{property:"og:title",content:y.title}),r.createElement("meta",{property:"og:url",content:y.url}),r.createElement("meta",{property:"og:description",content:y.description}),r.createElement("meta",{property:"og:image",content:y.image}),r.createElement("meta",{property:"og:type",content:"website"}),r.createElement("meta",{property:"og:image:alt",content:y.description}),r.createElement("meta",{name:"twitter:card",content:"summary_large_image"}),r.createElement("meta",{name:"twitter:title",content:y.title}),r.createElement("meta",{name:"twitter:url",content:y.url}),r.createElement("meta",{name:"twitter:description",content:y.description}),r.createElement("meta",{name:"twitter:image",content:y.image}),r.createElement("meta",{name:"twitter:image:alt",content:y.description}),r.createElement("meta",{name:"twitter:creator",content:g}),r.createElement("meta",{name:"gatsby-theme",content:"@lekoarts/gatsby-theme-minimal-blog"}),r.createElement("link",{rel:"icon",type:"image/png",sizes:"32x32",href:(0,o.withPrefix)("/favicon-32x32.png")}),r.createElement("link",{rel:"icon",type:"image/png",sizes:"16x16",href:(0,o.withPrefix)("/favicon-16x16.png")}),r.createElement("link",{rel:"apple-touch-icon",sizes:"180x180",href:(0,o.withPrefix)("/apple-touch-icon.png")}),s?r.createElement("link",{rel:"canonical",href:s}):null,c)}},8926:function(e,t,n){n.r(t),n.d(t,{Head:function(){return s.F},default:function(){return u}});var r=n(7294),o=n(1151),a=n(8356),i=n.n(a)()({loader:()=>Promise.all([n.e(992),n.e(352),n.e(12)]).then(n.bind(n,2012)),loading(){return r.createElement("div",null,"Loading...")}});function l(e){const t=Object.assign({p:"p",a:"a",h3:"h3",ol:"ol",li:"li",pre:"pre",code:"code"},(0,o.ah)(),e.components);return r.createElement(r.Fragment,null,r.createElement(t.p,null,"My new blog is built with ",r.createElement(t.a,{href:"https://www.gatsbyjs.org/"},"Gatsby.js")," and my goal is to make easy to insert\nsheet music and guitar tab into blog posts. I'm a big fan of the ",r.createElement(t.a,{href:"https://vexflow.com/"},"Vexflow Music Notation library"),"\nand for this post I'm going to explain how I got Vexflow working with Gatsby."),"\n",r.createElement(t.h3,null,"Demo"),"\n",r.createElement(t.p,null,"I struggled a bit with server-side rendering, but eventually got it working! Here's the end result:"),"\n",r.createElement(i,{width:"700",height:"180"}),"\n",r.createElement(t.h3,null,"Integration Details"),"\n",r.createElement(t.p,null,"There are 3 things I had to do to get Vexflow working with Gatsby.js."),"\n",r.createElement(t.ol,null,"\n",r.createElement(t.li,null,r.createElement(t.a,{href:"https://github.com/jamiebuilds/react-loadable"},"react-loadable")," - The Gatsby framework renders everything\nserver-side and Vexflow does not play nicely by default. The Vexflow library depends on 'window' and several\nother browser features. To work around this issue I used react-loadable to only load my VexflowDemo component on the client-side."),"\n"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-jsx"},'import React from "react";\nimport Loadable from "react-loadable";\n\nexport default Loadable({\n  // this "./VexflowDemo" component loads Vexflow and draws the sheet music\n  loader: () => import("./VexflowDemo"),\n  loading() {\n    return <div>Loading...</div>;\n  },\n});\n')),"\n",r.createElement(t.ol,{start:"2"},"\n",r.createElement(t.li,null,"\n",r.createElement(t.p,null,r.createElement(t.a,{href:"https://reactjs.org/docs/refs-and-the-dom.html"},"DOM Node Ref")," - the Vexflow library takes care of the complex\nrendering for creating sheet music. It just needs a specific container element to use. The 'ref' feature makes it easy to\nshare the container element with Vexflow without having to hardcode any id values."),"\n"),"\n",r.createElement(t.li,null,"\n",r.createElement(t.p,null,r.createElement(t.a,{href:"https://reactjs.org/docs/hooks-effect.html"},"useEffect Hook")," - the Vexflow rendering process requires\na DOM node reference so we need to make sure the DOM is ready. With React, we can accomplish this using 'useEffect' or 'componentDidMount()'."),"\n"),"\n"),"\n",r.createElement(t.p,null,"Here's a snippet showing how to use 'useEffect' with 'ref':"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-jsx"},"function VexflowDemo(props) {\n  const notesContainerRef = React.useRef(null);\n\n  useEffect(() => {\n    if (notesContainerRef.current !== null) {\n      // this draw() function contains all Vexflow code for rendering the sheet music\n      draw(notesContainerRef.current, props);\n    }\n  });\n\n  return <div ref={notesContainerRef} />;\n}\n")),"\n",r.createElement("hr"),"\n",r.createElement(t.p,null,"Check out the ",r.createElement(t.a,{href:"https://github.com/gregjopa/gregjopa.github.io/tree/source/content/posts/integrating-vexflow-with-gatsby-js"},"full source code for this blog post"),"."))}var c=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,o.ah)(),e.components);return t?r.createElement(t,e,r.createElement(l,e)):l(e)},s=n(8804);function u(e){return r.createElement(s.Z,e,r.createElement(c,e))}s.Z},8356:function(e,t,n){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=n(7294),c=n(5697),s=[],u=[];function m(e){var t=e(),n={loading:!0,loaded:null,error:null};return n.promise=t.then((function(e){return n.loading=!1,n.loaded=e,e})).catch((function(e){throw n.loading=!1,n.error=e,e})),n}function d(e){var t={loading:!1,loaded:{},error:null},n=[];try{Object.keys(e).forEach((function(r){var o=m(e[r]);o.loading?t.loading=!0:(t.loaded[r]=o.loaded,t.error=o.error),n.push(o.promise),o.promise.then((function(e){t.loaded[r]=e})).catch((function(e){t.error=e}))}))}catch(r){t.error=r}return t.promise=Promise.all(n).then((function(e){return t.loading=!1,e})).catch((function(e){throw t.loading=!1,e})),t}function p(e,t){return l.createElement((n=e)&&n.__esModule?n.default:n,t);var n}function f(e,t){var m,d;if(!t.loading)throw new Error("react-loadable requires a `loading` component");var f=Object.assign({loader:null,loading:null,delay:200,timeout:null,render:p,webpack:null,modules:null},t),h=null;function g(){return h||(h=e(f.loader)),h.promise}return s.push(g),"function"==typeof f.webpack&&u.push((function(){if(e=f.webpack,"object"===r(n.m)&&e().every((function(e){return void 0!==e&&void 0!==n.m[e]})))return g();var e})),d=m=function(t){function n(r){o(this,n);var i=a(this,t.call(this,r));return i.retry=function(){i.setState({error:null,loading:!0,timedOut:!1}),h=e(f.loader),i._loadModule()},g(),i.state={error:h.error,pastDelay:!1,timedOut:!1,loading:h.loading,loaded:h.loaded},i}return i(n,t),n.preload=function(){return g()},n.prototype.componentWillMount=function(){this._mounted=!0,this._loadModule()},n.prototype._loadModule=function(){var e=this;if(this.context.loadable&&Array.isArray(f.modules)&&f.modules.forEach((function(t){e.context.loadable.report(t)})),h.loading){"number"==typeof f.delay&&(0===f.delay?this.setState({pastDelay:!0}):this._delay=setTimeout((function(){e.setState({pastDelay:!0})}),f.delay)),"number"==typeof f.timeout&&(this._timeout=setTimeout((function(){e.setState({timedOut:!0})}),f.timeout));var t=function(){e._mounted&&(e.setState({error:h.error,loaded:h.loaded,loading:h.loading}),e._clearTimeouts())};h.promise.then((function(){t()})).catch((function(e){t()}))}},n.prototype.componentWillUnmount=function(){this._mounted=!1,this._clearTimeouts()},n.prototype._clearTimeouts=function(){clearTimeout(this._delay),clearTimeout(this._timeout)},n.prototype.render=function(){return this.state.loading||this.state.error?l.createElement(f.loading,{isLoading:this.state.loading,pastDelay:this.state.pastDelay,timedOut:this.state.timedOut,error:this.state.error,retry:this.retry}):this.state.loaded?f.render(this.state.loaded,this.props):null},n}(l.Component),m.contextTypes={loadable:c.shape({report:c.func.isRequired})},d}function h(e){return f(m,e)}h.Map=function(e){if("function"!=typeof e.render)throw new Error("LoadableMap requires a `render(loaded, props)` function");return f(d,e)};var g=function(e){function t(){return o(this,t),a(this,e.apply(this,arguments))}return i(t,e),t.prototype.getChildContext=function(){return{loadable:{report:this.props.report}}},t.prototype.render=function(){return l.Children.only(this.props.children)},t}(l.Component);function y(e){for(var t=[];e.length;){var n=e.pop();t.push(n())}return Promise.all(t).then((function(){if(e.length)return y(e)}))}g.propTypes={report:c.func.isRequired},g.childContextTypes={loadable:c.shape({report:c.func.isRequired}).isRequired},h.Capture=g,h.preloadAll=function(){return new Promise((function(e,t){y(s).then(e,t)}))},h.preloadReady=function(){return new Promise((function(e,t){y(u).then(e,e)}))},e.exports=h}}]);
//# sourceMappingURL=component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx-content-file-path-home-runner-work-gregjopa-github-io-gregjopa-github-io-content-posts-integrating-vexflow-with-gatsby-js-index-mdx-4ce1f4965f66aaae3993.js.map